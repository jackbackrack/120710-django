{% extends 'market/base.html' %}

{% block title %}{{ show.name }}{% endblock %}
{% block block_title %}{{ show.name }}{% endblock %}

{% block content %}
<div class="cards">
<div class="card">
  {% if show.image %}
  <img src="{{ show.image.url }}" class="card__image">
  {% endif %}
  <div class="card__contents">
    <h1 class="mb-6 text-3xl">{{ show.name }}</h1>
    <p class="mb-6 text-3xl">{{ show.start }} - {{ show.end }}</p>
    <h3 class="mb-6">Curated by:
    {% for curator in show.curators.all %}
    <a class="card__link" href="{% url 'piece:artist_detail' curator.id %}">{{ curator.name }}</a>
    {% endfor %}
    </h3>
    {% if show.description %}
    <p class="text-gray-500 text-sm"><strong>Description: </strong>{{ show.description }}</p>
    {% endif %}
    {% for event in show.events.all %}
    <h3 class="mb-6"> <a class="card__link" href="{% url 'piece:event_detail' event.id %}"> {{ event.name }}</a>:
    {{ event.start }} - {{ event.end }}</h3>
    {% endfor %}
  </div>
  <div class="card__info">
  {% if user.is_authenticated %}
    <a class="card__link" href="{% url 'piece:show_edit' show.pk %}">Edit</a>
    <a class="card__link" href="{% url 'piece:show_delete' show.pk %}">Delete</a>
  {% endif %}
  </div>
</div>
</div>
<div style="text-align:center"><h2>Artworks</h2></div>
<div class="cards">
{% for piece in show.pieces.all %}
  <div class="card">
    {% if piece.image %}
    <img src="{{ piece.image.url }}" class="card__image">
    {% endif %}
    <div class="card__contents">
      <h2 class="text-sm">{% for artist in piece.artists.all %}<a class="card__link" href="{% url 'piece:artist_detail' artist.id %}"> {{ artist }}</a>{% endfor %}
      </h2>
      <h2 class="text-sm"><a class="card__link" href="{{ piece.get_absolute_url }}">{{ piece.name }}</a> </h2>
      <h2 class="text-sm">
        {% if piece.start_year %}
        {{ piece.start_year }}-
        {% endif %}
        {{ piece.end_year }}
      </h2>
      <p class="text-gray-500 text-xs"><strong>Medium: </strong>{{ piece.medium }}</p>
      <p class="text-gray-500 text-xs"><strong>Dimensions: </strong>{{ piece.dimensions }}</p>
      <p class="text-gray-500 text-sm"><strong>Price:</strong>
        {% if piece.price %}
        ${{ piece.price }}
        {% endif %}
        {% if piece.pricing %}
        {{ piece.pricing }}
        {% endif %}
        {% if piece.is_sold %}
        <strong>sold</strong>
        {% endif %}
      </p>
    </div>
    <div class="card__info">  
      {% if user.is_authenticated %}
      <a class="card__link" href="{% url 'piece:piece_edit' piece.pk %}">Edit</a>
      <a class="card__link" href="{% url 'piece:piece_delete' piece.pk %}">Delete</a>
      {% endif %}
    </div>
  </div>
{% endfor %}
</div>
<div style="text-align:center"><h2>Artists</h2></div>
<div class="cards">
  <!-- todo: remove dups and sort -->
  {% for piece in show.pieces.all %}
  {% for artist in piece.artists.all %}
  <div class="card">
    {% if artist.image %}
    <img src="{{ artist.image.url }}" class="card__image">
    {% endif %}
    <div class="card__contents"><a class="card__link" href="{{ artist.get_absolute_url }}">{{ artist.name }}</a></div>
    <div class="card__info">
    {% if user.is_authenticated %}
        <a class="card__link" href="{% url 'piece:artist_edit' artist.pk %}">Edit</a>
        <a class="card__link" href="{% url 'piece:artist_delete' artist.pk %}">Delete</a>
    {% endif %}
    </div>
  </div>
  {% endfor %}
  {% endfor %}
</div>
{% endblock %}
